#include <stdio.h>
#include <string.h>
#include <math.h>
#include <stdlib.h>
char prefix(char *P,int *pi)
{
int m=strlen(P);
pi[1]=0;
int k=0;
for(int q=2;q<=m;q++)
{
while(k>0&&P[k+1]!=P[q])
k=pi[k];
if(P[k+1]==P[q])
k=k+1;

pi[q]=k;

}
for(int i=1;i<=m;i++)
printf("%d",pi[i]);
return *pi;
}

void KMP(char *T,char *P)
{
int n=strlen(T);
int m=strlen(P);
int *pi=(int*)malloc(sizeof(int)*m);
for(int j=1;j<=m;j++)
pi[j]=prefix(P,pi);

int q=0;
for(int i=1;i<=n;i++)
{
while(q>0&&P[q+1]!=T[i])
q=pi[q];

if(P[q+1]==T[i])
q=q+1;


if(q==m)
{
printf("Pattern occurs with shift %d",i-m);
q=pi[q];
}
}
}     


int main()
    {
int m,n;
   // char *P,*T;
   // scanf("%d %d",&m,&n);

/*for(int i=0;i<m;i++)
scanf("%s",&P);

for(int j=0;j<n;j++)
scanf("%s",&*T[j]);*/
 char *T = "ABABDABACDABABCABAB";
   char *P = "ABABCABAB";
KMP(T,P); 

return 0;
    	
}
    
    
